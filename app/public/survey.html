<!DOCTYPE html>
<head>
	<meta charset="UTF-8">
	<title>FriendFinder</title>

	<!--jQuery-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
   	
	<!-- Materialize -->

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
	<!-- Materialize Icons -->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

 	<!-- Compiled and minified CSS -->
 	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

 	<!-- Compiled and minified JavaScript -->
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>


</head>

<body>
	<div id="blob" class="container">

		<h2><strong>Survey Questions</strong></h2>

		<div class = "card-panel orange lighten-5">

			<h5><strong>About you</strong></h5>

			<div class="row">
			    <form class="col s12">
				    <div class="row">
				        <div class="input-field col s6">
					        <i class="material-icons prefix">account_circle</i>
					        <input id="icon_prefix" type="text" class="validate">
					        <label id= "name" class = "qform" for="icon_prefix">Name (Required)</label>
				        </div>
				    </div>
			    </form>
			</div>

			<div class="row">
			    <form class="col s12">
				    <div class="row">
				        <div class="input-field col s6">
					        <i class="material-icons prefix">photo_camera</i>
					        <input id="icon_prefix" type="text" class="validate">
					        <label id = "photo" class = "qform" for="icon_prefix">Link to photo (Required)</label>
				        </div>
				    </div>
			    </form>
			</div>

		</div>	

		<div class="card-panel orange lighten-5">

			<h5>Question 1</h5>
			<p><strong>I like pizza</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q1">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />
                
			<h5>Question 2</h5>
			<p><strong>I love pasta</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q2">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>

			<h5>Question 3</h5>
			<p><strong>I love cake</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q3">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 4</h5>
			<p><strong>I love kimchi</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q4">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 5</h5>
			<p><strong>I love kombucha</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q5">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 6</h5>
			<p><strong>I drink tons of coffee</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q6">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 7</h5>
			<p><strong>I drink lots of water</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q7">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 8</h5>
			<p><strong>I like running</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q8">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 9</h5>
			<p><strong>I like cats</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q9">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

			<h5>Question 10</h5>
			<p><strong>I like dogs</strong></p>

			  <select data-placeholder="" class="qselect browser-default" id="q10">
                    <option value="">Choose an option</option>
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            <br />

		</div>

		<button id="submitButton" class="btn waves-effect waves-light btn-large" type="submit" name="action">Submit
  			  <i class="material-icons right">send</i>
 		</button>
        
	</div>


<div id="resultsMatch" class = "container"> 

	<div class="row">
		<div class="col l6 offset-l3 center-align">
			<h4>Meet your new friend!</h4>
		</div>
	</div>		

	<div class="row">
		<div class="col l6 offset-l3">

				<h4 id="matchName" class="center-align"></h4>
				<img id="matchPhoto" src="" alt="Image Not Found" style="max-width: 450px;">
		</div>
	</div>		
        
</div>


  
<script type="text/javascript">

var allFieldsCompleted;
   
$(document).ready(function() {

	$("#resultsMatch").hide();

    // Event Listener for Submission
    $('#submitButton').on('click', function() {
          
        
        if (validateForm) {
              collectInputs();
         
        }
            
        else {
              alert('Please complete all fields before submitting!');
             }
          }); // end checkIfComplete() callback



 function validateForm() {
			        var validate = true;
			        $(".qform").each(function() {
			          if ($(this).val() === "") {
			            validate = false;
			          }
			        });
			        $(".qselect").each(function() {
			          if ($(this).val() === "") {
			            validate = false;
			          }
			        });
			        return validate;
			    }




      function collectInputs(){

        // Make new friend object
        var newFriend = {
          name: $('#name').val().trim(),
          photo: $('#photo').val().trim(),
          scores: []
        };

        console.log("This is the new Friend" + newFriend);

 // Loop through Questions to get scores
 var scoresArray = [];

        $('.qselect').each(function(){
          scoresArray.push( parseInt( $(this).val() ) ); // Parse Input Value as integer
        })
         // This counters the async behavior of $.each()
        .promise().done(function(){
          
          // Push the array of scores to the new friend object
          newFriend.scores = scoresArray;

          // POST the newFriend to the friends.js file and get back the best match
          var currentURL = window.location.origin;
          $.post(currentURL + "/api/friends", newFriend, function(data){

          	$("#blob").hide();
          	$("#resultsMatch").show();

            // Add Best Match attributes to Modal
            $('#matchName').text(data.name);
            $('#matchPhoto').attr('src', data.photo);

            // Show the modal with the best match 
            // $("#resultsModal").modal('toggle');
            // instance.open();
          }); // end AJAX POST
        });
      }

});
		
	</script>

</body>
